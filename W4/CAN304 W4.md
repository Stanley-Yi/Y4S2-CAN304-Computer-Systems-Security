# CAN304 W4

## The public-key revolution

å¯¹ç§°åŠ å¯† (symmetric cryptograph) å¸¦æ¥äº†ä¸€ç³»åˆ—å®‰å…¨é—®é¢˜ï¼šå¦‚ä½•å®‰å…¨åœ°å…±äº«å¯†é’¥ï¼Ÿå¤šä¸ªäººå¦‚ä½•å…±äº«å¯†é’¥ (æ¯ä¸¤äººä¸€ä¸ªï¼Ÿ)ï¼Ÿ



éå¯¹ç§°åŠ å¯† (asymmetric cryptography)ï¼šä¸€æ–¹ç”Ÿæˆä¸€å¯¹å¯†é’¥ - å…¬é’¥pk å’Œç§é’¥ skï¼Œå…¬é’¥è¢«å¹¿æ³›ä¼ æ’­ï¼Œç§é’¥æ˜¯ä¿å¯†çš„ã€‚



ä¸€äº›é—®é¢˜è¡¨ç°å‡ºéå¯¹ç§°æ€§ - æ˜“äºè®¡ç®—ï¼Œä½†éš¾ä»¥åè½¬ (invert)ã€‚æˆ‘ä»¬ä½¿ç”¨è¿™äº›é—®é¢˜æ„å»ºéå¯¹ç§°åŠ å¯†ã€‚

* Factoring problemï¼šè®¡ç®—ä¸¤ä¸ªæ•°å­—çš„ä¹˜ç§¯å¾ˆå®¹æ˜“ï¼›ä½†æ ¹æ®ä¹˜ç§¯åˆ†è§£æ•°å­—å¾ˆéš¾



## Public-key encryption

**Public-key encryption (PKE)** 

public-key encryption scheme ç”±ä¸‰ç§ç®—æ³•ç»„æˆï¼š

* Genï¼škey-generation algorithmï¼Œç”Ÿæˆå…¬é’¥ pk å’Œç§é’¥ sk
* Encï¼šæ ¹æ®è¾“å…¥ pk å’Œ message mï¼Œè¾“å‡ºå¯†æ–‡ c çš„åŠ å¯†ç®—æ³•
* Decï¼šæ ¹æ®è¾“å…¥ sk å’Œå¯†æ–‡ cï¼Œè¾“å‡º message m æˆ– âŠ¥ (error) çš„è§£å¯†ç®—æ³•

<img src="D:\Files\Learning Materials\Y4\Semester-2\CAN304\MD Picture\W4 Public-key encryption.png" alt="W4 Public-key encryption" style="zoom: 50%;" />



**Hybrid encryption**

<img src="D:\Files\Learning Materials\Y4\Semester-2\CAN304\MD Picture\W4 Hybrid encryption.png" alt="W4 Hybrid encryption" style="zoom: 50%;" />

ä½¿ç”¨å¯¹ç§°åŠ å¯†å¯¹ m è¿›è¡ŒåŠ å¯†ï¼Œç„¶åç”¨éå¯¹ç§°åŠ å¯†å¯¹å¯†é’¥ k è¿›è¡ŒåŠ å¯†ã€‚è§£å¯†æ—¶å…ˆç”¨ç§é’¥è§£å¯† kï¼Œå†ç”¨ k è§£å¯†å¯†æ–‡ã€‚(ç”±äº m ä¼šå¾ˆé•¿ï¼Œç›´æ¥ç”¨éå¯¹ç§°åŠ å¯†è®¡ç®—é‡ä¼šå¾ˆå¤§)



**Dlog-based PKE: ElGamal encryption**

Dlog problemï¼šç»™å®š ğ‘” å’Œ group ğº ä¸­çš„ä¸€ä¸ªå…ƒç´  â„ï¼Œæ‰¾åˆ° x ä½¿å¾— ğ‘”^x^ = hã€‚

* Gen
  * åˆå§‹åŒ– group å‚æ•° Gï¼Œqï¼Œgï¼›é€‰æ‹© uniform $x \in Z_q$â€‹ (Z~q~ = {1, 2, ..., q-1})ï¼Œè®¡ç®—  h = ğ‘”^x^
  * Public key is â„, private key is ğ‘¥
* Enc~pk~(m), where $m \in G$
  * é€‰æ‹© uniform $y \in Z_q$
  * The ciphertext is $ (ğ‘_1, \ ğ‘_2) = (ğ‘”^y, \ â„^y â‹… ğ‘š)$
* Dec~sk~(c~1~, c~2~)
  * è§£å¯†è¾“å‡º $\frac{c_2} {c_1^x}$



**RSA encryption**

![W4 RSA](D:\Files\Learning Materials\Y4\Semester-2\CAN304\MD Picture\W4 RSA.png)



**Chosen-plaintext attack (CPA)**

æ”»å‡»ç±»å‹ï¼šCiphertext-only attack -> Known-plaintext attack -> Chosen-plaintext attack -> Chosen-ciphertext attackï¼Œå¼ºåº¦ä¾æ¬¡å¢åŠ ã€‚



<img src="D:\Files\Learning Materials\Y4\Semester-2\CAN304\MD Picture\W4 Chosen-plaintext attack.png" alt="W4 Chosen-plaintext attack" style="zoom:50%;" />

å‡å¦‚æ”»å‡»è€…çŸ¥é“ä¸€äº› plaintext-ciphertext pairsï¼Œä¾‹å¦‚ (m~1~, c~1~) å’Œ (m~2~, c~2~)ã€‚ç°åœ¨æœ‰ä¸€ä¸ªå¯†æ–‡ c~3~ï¼Œå¦‚æœ $c_1 \sdot c_2 = c_3$ï¼Œé‚£ä¹ˆ $m_1 \sdot m_2 = m_3$ã€‚

å› æ­¤ï¼ŒPlain RSA is not CPA-secureï¼Œä¸è¿‡è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ PKCS è§£å†³ã€‚



PKCS: Public-Key Cryptography Standard (PKCS)

* ideaï¼šadd random padding
  * è¦åŠ å¯† ğ‘šï¼Œéšæœºé€‰æ‹©ä¸€ä¸ª ğ‘Ÿï¼ŒæŠŠ r æ·»åŠ åˆ° m é‡Œ
  * $c = [(r|m)^e mod N]$



## Digital signature

Digital signature å’Œ MACs çš„åŒºåˆ«ï¼š

* Public verifiability
  * â€œä»»ä½•äººâ€éƒ½å¯ä»¥éªŒè¯ signatureï¼Œè€Œåªæœ‰å¯†é’¥æŒæœ‰è€…æ‰èƒ½éªŒè¯ MAC çš„ tag
* Transferability
  * å¯ä»¥å°† signature è½¬å‘ç»™å…¶ä»–äºº
* Non-repudiation
  * ç­¾åè€…ä¸èƒ½ï¼ˆè½»æ˜“åœ°ï¼‰å¦è®¤ç­¾å‘çš„ç­¾å (å¯ä»¥ä½¿ç”¨ pk çš„å…¬å…±å‰¯æœ¬éªŒè¯ç­¾å)
  * è€Œ MAC æ— æ³•æä¾›æ­¤åŠŸèƒ½ (æ— æ³•è®¿é—®å¯†é’¥ï¼Œæ— æ³•éªŒè¯ tag)ï¼Œè€Œä¸”æ— æ³•ç¡®å®šæ˜¯è°å‘å‡ºçš„ç­¾å (æœ‰å¯†é’¥çš„éƒ½å¯ä»¥å‘)



**Signature schemes**

ç­¾åæ–¹æ¡ˆç”±ä¸‰ç§ PPT ç®—æ³•ï¼ˆGenã€Signã€Vrfyï¼‰å®šä¹‰ï¼š

* Genï¼šè¾“å…¥ 1^n^ (æŒ‡å®šå¯†é’¥é•¿åº¦)ï¼Œè¾“å‡º pk å’Œ sk

* Signï¼šå°†ç§é’¥ sk å’Œ message $m \in \{0, 1\}^*$ï¼Œè¾“å‡º signature $\sigma$
  $$
  \sigma \leftarrow Sign_{sk} (m)
  $$

* Vrfyï¼šè¾“å…¥å…¬é’¥ pkï¼Œmessage m å’Œ signature $\sigma$ï¼Œè¾“å‡º 0 æˆ– 1 (æ‹’ç»å’Œæ¥å—)

<img src="D:\Files\Learning Materials\Y4\Semester-2\CAN304\MD Picture\W4 Signature schemes.png" alt="W4 Signature schemes" style="zoom: 50%;" />



**Hash-and-sign paradigm**

ç»™å®šï¼š

* ä¸€ä¸ª signature scheme Î =(Gen, Sign, Vrfy) æ¥ç­¾åé•¿åº¦ä¸º n çš„çŸ­ message
* Hash function $H: \{0,1\}^* \rightarrow \{0,1\}^n$



æ„å»ºä¸€ä¸ªå¯ä»¥é€‚ç”¨äºä»»æ„é•¿åº¦ message çš„ signature scheme Î â€˜ =(Genâ€™, Signâ€˜, Vrfyâ€™)ï¼š

* $Sign_{sk}' (m) = Sign_{sk}(H(m))$
* $Vrfy_{pk}' (m, \sigma) = Vrfy_{pk}(H(m), \sigma)$



**RSA-based signatures**

![W4 RSA-based signatures](D:\Files\Learning Materials\Y4\Semester-2\CAN304\MD Picture\W4 RSA-based signatures.png)



**Attacks**

* sign specific messages
  * å‡å¦‚ç»™å®š m=1ï¼Œå¯ä»¥å¾—åˆ° $\sigma=1$ï¼Œå› ä¸º $\sigma = [1^d mode N] = 1$
* sign â€œrandomâ€ messages
  * é€‰æ‹©éšæœºçš„ $\sigma$ï¼Œè®¾ç½® $m = [\sigma ^e mode N]$
* combine two signatures to obtain a third
  * ç­¾å $\sigma_1,\ \sigma_2$ æ˜¯åˆæ³•çš„ç­¾åï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”äº $m_1, \ m_2$
  * é‚£ä¹ˆ $\sigma' = \sigma_1 \sigma_2 \ mod \ N$ æ˜¯åˆæ³•çš„ç­¾åï¼Œå®ƒå¯¹åº”äº $m' = m_1 m_2 \ mod \ N$ã€‚å› ä¸º $(\sigma_1 \sigma_2)^e = \sigma_1^e \sigma_2^e = m_1 m_2 \ mod \ N$



**RSA-FDH**

RSA-FDH: RSA full-domain hashï¼Œä¹Ÿæ˜¯ä¸€ä¸ª Hash-and-sign paradigmã€‚

<img src="D:\Files\Learning Materials\Y4\Semester-2\CAN304\MD Picture\W4 RSA-FDH.png" alt="W4 RSA-FDH" style="zoom: 50%;" />



## Diffie-Hellman key agreement

Decisional Diffie-Hellman (DDH) problemï¼šç»™å®š $g^x$ å’Œ $g^y$ï¼Œè¦ä» $g^{xy}$ ä¸­æ‰¾åˆ°å®ƒä»¬å¾ˆå›°éš¾ã€‚

Gï¼šcyclic groupï¼›ğ‘: prime, order of ğºï¼›ğ‘”: generator of ğºã€‚

![W4 Diffie-Hellman key agreement](D:\Files\Learning Materials\Y4\Semester-2\CAN304\MD Picture\W4 Diffie-Hellman key agreement.png)

ä¸¤äººåˆ†åˆ«ä» Z~q~ ä¸­ç”Ÿæˆ x å’Œ yï¼Œç„¶åè®¡ç®—å‡º h~1~ å’Œ h~2~ å¹¶äº¤æ¢ï¼Œæœ€åç”Ÿæˆ k~1~ å’Œ k~2~ï¼Œk~1~ å’Œ k~2~ æ˜¯ç›¸ç­‰çš„ (å› ä¸º $(g^x)^y = (g^y)^x$)ã€‚



**Elliptic curve Diffie-Hellman key agreement**

ECDDH problemï¼šç»™å®š yP å’Œ xPï¼Œè¦ä» xyP ä¸­åŒºåˆ†å®ƒä»¬å¾ˆå›°éš¾ã€‚

ğ¸: elliptic curve groupï¼›ğ‘: prime, order of ğ¸ï¼›ğ‘ƒ: generator of ğ¸ã€‚

![W4 ECDDh](D:\Files\Learning Materials\Y4\Semester-2\CAN304\MD Picture\W4 ECDDh.png)

k~1~ å’Œ k~2~ ä¹Ÿæ˜¯ç›¸ç­‰çš„ (å› ä¸º $xyP = yxP$)ã€‚



**Man-in-the-middle to EC(DH)**

![W4 Man-in-the-middle to EC(DH)](D:\Files\Learning Materials\Y4\Semester-2\CAN304\MD Picture\W4 Man-in-the-middle to EC(DH).png)

æ”»å‡»è€…å¯ä»¥æ›¿æ¢åŒæ–¹çš„å¯†é’¥ï¼Œç„¶å k~1~ å’Œ k~3~ ç›¸ç­‰ï¼Œk~2~ å’Œ k~4~ ç›¸ç­‰ã€‚

å¯ä»¥é€šè¿‡åœ¨åè®®ä¸­å¼•å…¥èº«ä»½éªŒè¯ (authentication) æ¥è§£å†³ã€‚

